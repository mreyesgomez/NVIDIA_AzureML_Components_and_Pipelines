$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
name: tao_body_pose_evaluate
display_name: tao_body_pose_evaluate
description: Wrapper for TAO command bpnet evaluate, which is used to evaluate the performance of a model. It uses the same configuration specs as the TAO detectnet_v2 train command <a href=https://github.com/mreyesgomez/NVIDIA_AzureML_Components_and_Pipelines/tree/main/components/tao/tfv3.22.05-tf1.15.4/object_detection/detectnet_v2/tao_detectnet_v2_evaluate/README.md>Reference file</a>
version: 4
type: command
inputs:
  original_specs:
    type: uri_folder
  specs_file:
    type: string
    default: infer_spec.yaml
  target_model_dir: 
    type: uri_folder
  key:
    type: string
    default: tlt_encode
  model_app_name:
    type: string
    default: bpnet
  base_model_dir:
    type: uri_folder
  base_model_subdir:
    type: string
    default: ND
  specfile_reference_model_dir:
    type: string
  specfile_reference_train_dir:
    type: string
  model_name:
    type: string
    default: model.tlt
  model_subfolder:
    type: string
    default: exp_m1_unpruned
  train_specs_dir:
    type: uri_folder
outputs:
  updated_infer_spec_dir:
    type: uri_folder
  eval_results_dir:
    type: uri_folder
code: ./
environment: azureml://registries/hwolff-registry/environments/tao-toolkit-4.0.0-tf1.15.5/versions/2
command: >-
  bash ./update_and_evaluate.sh 
  ${{inputs.original_specs}} 
  ${{inputs.specs_file}} 
  ${{inputs.key}} 
  ${{inputs.base_model_dir}}/${{inputs.model_app_name}}/${{inputs.base_model_subdir}} 
  ${{inputs.specfile_reference_model_dir}}
  ${{inputs.model_name}} 
  ${{inputs.model_app_name}}/${{inputs.model_subfolder}} 
  ${{inputs.target_model_dir}}
  ${{inputs.specfile_reference_model_dir}}
  ${{inputs.specfile_reference_train_dir}}
  ${{outputs.updated_infer_spec_dir}}
  ${{outputs.eval_results_dir}}
  ${{inputs.train_specs_dir}}

  